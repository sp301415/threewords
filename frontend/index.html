<!doctype html>
<html lang="ko">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noindex">

    <title>세 단어로 나눠요</title>

    <meta property="og:title" content="세 단어로 나눠요" />
    <meta name="author" content="sp301415" />
    <meta property="og:locale" content="ko_KR" />
    <meta name="description" content="세 단어 파일 공유 서비스" />
    <meta property="og:description" content="세 단어 파일 공유 서비스" />
    <link rel="canonical" href="https://threewords.sp301415.com" />
    <meta property="og:url" content="https://threewords.sp301415.com" />
    <meta property="og:site_name" content="세 단어로 나눠요" />
    <meta property="og:image" content="https://threewords.sp301415.com/cover.jpg" />
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta property="twitter:image" content="https://threewords.sp301415.com/cover.jpg" />
    <meta property="twitter:title" content="세 단어로 나눠요" />

    <link rel="stylesheet" href="css/pico.min.css">
    <style>
        :root {
            --grid-spacing-horizontal: 5rem;
        }

        hr {
            margin: var(--spacing) 0;
        }

    </style>
    <script>
        function upload() {
            let button = document.getElementById("upload_button");
            let file_input = document.getElementById("upload");
            let file = file_input.files[0];
            let formData = new FormData();

            if (file.size >= 100 * (1 << 20)) {
                alert("파일 사이즈가 너무 큽니다! 100MB까지 지원합니다.");
                return;
            }

            button.ariaBusy = "true";
            file_input.disabled = true;
            formData.append("upload", file);
            fetch('https://threewords-api.sp301415.com/upload', { method: "POST", body: formData })
                .then(response => Promise.all([response.ok, response.text()]))
                .then(response => {
                    if (response[0]) {
                        document.getElementById("upload_words").innerText = response[1];
                    } else {
                        alert(response[1]);
                        document.getElementById("upload_words").innerText = "";
                    }
                })
                .catch(err => console.log(err))
                .finally(_ => {
                    button.ariaBusy = "false";
                    file_input.disabled = false;
                });
        }
    </script>
</head>

<body>
    <main class="container">
        <article>
            <h1>세 단어로...</h1>
            <div class="grid">
                <div>
                    <h2>보내요</h2>
                    <input type="file" id="upload" name="upload">
                    <button onclick="upload()" id="upload_button">보내기</button>
                    <hr>
                    <div>
                        이 파일의 키는...
                        <h1 id="upload_words"></h1>
                    </div>
                </div>
                <div>
                    <h2>받아요</h2>
                    <form target="_blank" action="https://threewords-api.sp301415.com/download" method="post">
                        <input type="text" id="word0" name="word0" placeholder="첫번째 단어" required>
                        <input type="text" id="word1" name="word1" placeholder="두번째 단어" required>
                        <input type="text" id="word2" name="word2" placeholder="세번째 단어" required>
                        <button>받기</button>
                    </form>
                </div>
        </article>
    </main>
</body>

</html>
